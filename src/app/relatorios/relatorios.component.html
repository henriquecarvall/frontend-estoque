<div class="relatorios-container">
  <h2>üìä Relat√≥rios do Sistema</h2>

  <div class="loading" *ngIf="carregando">
    <div>üìà Carregando dados do sistema...</div>
  </div>

  <div *ngIf="!carregando" class="dashboard">
    <!-- Cards de Estat√≠sticas -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üì¶</div>
        <div class="stat-info">
          <h3>Total de Produtos</h3>
          <span class="stat-value">{{ totalProdutos }}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">üí∞</div>
        <div class="stat-info">
          <h3>Valor Total em Estoque</h3>
          <span class="stat-value">R$ {{ valorTotalEstoque.toFixed(2) }}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-info">
          <h3>Produtos com Estoque Baixo</h3>
          <span class="stat-value">{{ produtosEstoqueBaixo.length }}</span>
        </div>
      </div>
    </div>

    <!-- Lista de Produtos com Estoque Baixo -->
    <div class="estoque-baixo-section" *ngIf="produtosEstoqueBaixo.length > 0">
      <h3>‚ö†Ô∏è Produtos com Estoque Baixo (< 10 unidades)</h3>
      <table class="tabela-produtos">
        <thead>
        <tr>
          <th>C√≥digo</th>
          <th>Nome</th>
          <th>Estoque</th>
          <th>Pre√ßo</th>
          <th>Categoria</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let produto of produtosEstoqueBaixo">
          <td>{{ produto.codigo }}</td>
          <td>{{ produto.nome }}</td>
          <td class="estoque-baixo">{{ produto.quantidadeEstoque || 0 }}</td>
          <td>R$ {{ (produto.precoUnitario || 0).toFixed(2) }}</td>
          <td>{{ produto.categoria }}</td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Lista Completa de Produtos -->
    <div class="todos-produtos-section">
      <h3>üì¶ Todos os Produtos</h3>
      <table class="tabela-produtos">
        <thead>
        <tr>
          <th>C√≥digo</th>
          <th>Nome</th>
          <th>Estoque</th>
          <th>Pre√ßo Unit√°rio</th>
          <th>Valor Total</th>
          <th>Categoria</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let produto of produtos" [class.estoque-baixo]="(produto.quantidadeEstoque || 0) < 10">
          <td>{{ produto.codigo }}</td>
          <td>{{ produto.nome }}</td>
          <td>{{ produto.quantidadeEstoque || 0 }}</td>
          <td>R$ {{ (produto.precoUnitario || 0).toFixed(2) }}</td>
          <td>R$ {{ ((produto.precoUnitario || 0) * (produto.quantidadeEstoque || 0)).toFixed(2) }}</td>
          <td>{{ produto.categoria }}</td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Bot√£o Exportar -->
    <div class="acoes-relatorio">
      <button class="btn-exportar" (click)="exportarRelatorio()">
        üì• Exportar Relat√≥rio JSON
      </button>
    </div>
  </div>

  <button class="btn-voltar" routerLink="/">‚Üê Voltar para Home</button>
</div>
